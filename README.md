# üéØ Crowd-sourced Fitness Challenge App

This app enables users to create and participate in community-driven fitness challenges. Users can engage in challenges, chat with others, earn badges, and track progress all within a cross-platform mobile app.

## Features

### Key Objectives:
- **üîê User Accounts**: Secure login and registration for users.
- **üèãÔ∏è‚Äç‚ôÇÔ∏è Challenge Creation**: Users can create fitness challenges, set goals, select images, and add badges.
- **üîé Challenge Participation**: Users can search for challenges, chat with others, upload media, and complete goals.
- **üèÖ Badges and Wall of Fame**: Earn badges and be featured on the Wall of Fame for completing challenges.

## üõ†Ô∏è Technologies

- **Frontend**: React Native with Expo, TypeScript, Redux
- **Backend**: Google Cloud Functions
- **Database**: Supabase PostgreSQL for handling structured relational data storage with real-time features.
- **Authentication**: Supabase Authentication
- **Real-time Chat**: Firebase Firestore
- **Testing**: Jest
- **Project Management**: Trello, GitHub
- **Communication**: Discord

---

## üöÄ Backend Setup

### Steps to Set Up the Backend Locally:

1. Clone the repository:
   ```bash
   git clone https://github.com/paolacernada/Crowd-sourced-Fitness-Challenge-App.git
   cd Crowd-sourced-Fitness-Challenge-App
   ```

2. Create a `.env.server` file at the root of the `test_backend` folder and add the `SUPABASE_URL` and `SUPABASE_ANON_KEY`.

3. In a new terminal window, navigate to the `test_backend` folder:
   ```bash
   cd test_backend
   ```

4. Install dependencies and run the backend:
   ```bash
   npm install
   npm start
   ```
   * This installs the dependencies and runs the backend.
   * **Keep this terminal open** to continue running the backend.

---

## üì± Frontend Setup

### Steps to Set Up the Frontend Locally:

1. Install Expo CLI globally:
   ```bash
   npm install -g expo-cli
   ```

2. Create a `.env.frontend` file at the root of the `react_native_frontend` folder and add the `SUPABASE_URL` and `SUPABASE_ANON_KEY`.

3. In a new terminal window, navigate to the `react_native_frontend` folder:
   ```bash
   cd react_native_frontend
   ```

4. Install dependencies and run the frontend:
   ```bash
   npx expo install
   npx expo start
   ```

   *If your device is having network issues, try adding the `--tunnel` flag.*

5. Install Expo Go on your mobile device:
   - **Android**: [Expo Go on Google Play](https://play.google.com/store/apps/details?id=host.exp.exponent&hl=en_US)
   - **iOS**: [Expo Go on the App Store](https://apps.apple.com/us/app/expo-go/id982107779)

6. Scan the QR code generated by Expo with your device to preview the app.

---

## üîÑ Branch Protection and Pull Requests

1. Create a new branch:
   ```bash
   git checkout -b <branch-name>
   ```

2. Push the branch:
   ```bash
   git push origin <branch-name>
   ```

3. Open a pull request on GitHub. The GitHub Actions workflow will automatically check the code for linting errors before the merge.

---

## Local Backend Server

This TypeScript node.js backend server enables users to make backend function calls locally while developing instead of through Google Cloud Functions, avoiding unecessary usage fees.

### Steps to Set Up Locally:
1. Navigate to the /test_backend folder

2. Initialize the backend with a (separate) package.json
   ```bash
   npm init -y
   ```

3. Install dependencies:
   ```bash
   npm install
   ```

4. If there isn't a tsconfig.json file, run:
    ```bash
    npx tsc --init
    ```
5. Add script
   "start": "nodemon ts-node src/server.ts",

6. Add .env.server file 
   ```bash
   touch .env.server
   ```
   - Add the following to .env.server:
      SUPABASE_URL = (your SUPABASE_URL here)
      SUPABASE_ANON_KEY = (your SUPABASE_ANON_KEY here)

7. Run
      ```bash
      npm start
      ```

## React Native/Expo Setup
1. Install Expo Go CLI
   ```bash
   npm install -g expo-cli
   ```

2. Install ngrok (For tunneling with Expo)
   ```bash
   npm install --global @expo/ngrok@^4.1.0
   ```

3. Install project dependencies
   ```bash
   npm install
   ```

4. Install react-native-dotenv
   ```bash
   npm install react-native-dotenv --save
   ```

5. Add .env.frontend file 
   ```bash
   touch .env.frontend
   ```
   - Add the following to .env.server:
      SUPABASE_URL = (your SUPABASE_URL here)
      SUPABASE_ANON_KEY = (your SUPABASE_ANON_KEY here)

6. Create an Expo app (if you haven't already)
   ```bash
   create-expo-app@3.0.0
   ```

7. Install Expo Go on your iOS or Android device
   Android: https://play.google.com/store/apps/details?id=host.exp.exponent&hl=en_US
   iOS: https://apps.apple.com/us/app/expo-go/id982107779

8. Start your development server
   ```bash
   npx expo start
   ```
   *If your device is having network issues, try adding the --tunnel flag

9. Scan QR code with iOS or Android device
   The app should be visible on your phone!


## Notes/References
- Sample code is located in the **app-example** directory
- To learn more about developing your project with Expo, look at the following resources:
- [Expo documentation](https://docs.expo.dev/): Learn fundamentals, or go into advanced topics with our [guides](https://docs.expo.dev/guides).
- [Learn Expo tutorial](https://docs.expo.dev/tutorial/introduction/): Follow a step-by-step tutorial where you'll create a project that runs on Android, iOS, and the web.

---

# Supabase Edge Functions
### Installation
1. Install the supabase CLI (follow the instructions to add to PATH, etc.)
      ```bash
      brew install supabase/tap/supabase
      ```

2. Upgrade supabase CLI
      ```bash
      brew upgrade supabase
      ```

3. Log into Supabase. If you see an error (WSL may cause one) try adding the --no-browser flag
      ```bash
      supabase login
      ```

4. Initialize the Supabase project in the root folder:
   ```bash
   supabase init
   ```

<<<<<<< HEAD
5. Start the Supabase service:
   ```bash
   supabase start
   ```
=======
5. Run
      ```bash
      supabase start
      ```
### Deno installation
5. Install deno
      ```bash
      brew install deno
      ```
>>>>>>> aa19c3e (supabase/users CRUD options work when tested locally (although it gives inaccurate error messages))



- Install Deno extension
- create deno.json file in /supabase directory and add:
      {
  "compilerOptions": {
    "lib": ["deno.ns", "deno.unstable"]
  }
}


         Use Deno Only in the Supabase Directory
         Focus on the Supabase Directory: Write all your Deno code (Edge Functions) in the supabase/functions directory and ensure that your Node.js backend and React Native frontend remain unaffected by Deno.

         Run Deno Commands: When you need to run or test your Deno functions, navigate to the supabase/functions directory and use Deno commands as needed.

                  4. Keep Node.js for Other Parts of the Project
                  Continue Using Node.js: For your test_backend and react_native_frontend, continue using Node.js as you normally would. Ensure you don't mix Deno code in those directories.



To run (and test) a file locally in Deno:
deno run --allow-net --allow-read functions/users/index.ts




### Testing
1. Run exampleFunction locally for testing
      ```bash
      supabase functions serve exampleFunction
      ```

2. Deploy exampleFunction (to Supabase)
      ```bash
      supabase functions deploy functionName
      ```
   - Deployment URL can be found in terminal output after deployment

3. Update frontend to use deployed Edge Function URL instead of local routes.

# üìö Explore the Docs

- [Expo documentation](https://docs.expo.dev/): Learn fundamentals or explore advanced topics with [guides](https://docs.expo.dev/guides).
- [Learn Expo tutorial](https://docs.expo.dev/tutorial/introduction/): Create a project that runs on Android, iOS, and the web.
- [Supabase documentation](https://supabase.com/docs): Tutorials, APIs, and platform resources.

---